"0","#DMSD"
"0","library(jsonlite)"
"0","library(mitre)"
"0","library(burro)"
"0","library(dplyr)"
"0","library(ggplot2)"
"0","library(plyr)"
"0","library(markdown)"
"0","library(knitr)"
"0","library(stringr)"
"0","library(ggrepel)"
"0","library(xml2)"
"0",""
"0",""
"0","i <- 1"
"0","while (i<= nrow(MITREordered))"
"0","{"
"0","  aux <- grep(paste(""^"",MITREordered$Techniques[i],""$"",sep=""""),shield.relations$to)"
"0","  if (length(aux)>=1)"
"0","  {"
"0","    MITREordered$Shield[i] <- list(shield.relations$from[aux])"
"0",""
"0","  }else{"
"0","    aux <- grep(paste(""^"",substring(MITREordered$Techniques[i],1,str_length(MITREordered$Techniques[i])-4),""$"",sep=""""),shield.relations$to)"
"0","    MITREordered$Shield[i] <- list(shield.relations$from[aux])"
"0","    }"
"0","  i <- i + 1"
"0",""
"0","}"
"0",""
"0","i <- 1"
"0",""
"0","MITRESHIELD <- MITREordered[1,]"
"0","MITRESHIELD <- MITRESHIELD[-1,]"
"0",""
"0","while(i<=nrow(MITREordered))"
"0","{"
"0","  j <- length(unlist(MITREordered$Shield[i]))"
"0",""
"0",""
"0","  if (j>1)"
"0","  {"
"0",""
"0","    aux <- 0"
"0",""
"0","    while (aux < j)"
"0","    {"
"0","      MITRESHIELD <- rbind(MITRESHIELD,MITREordered[i,])"
"0","      MITRESHIELD[i+aux,ncol(MITRESHIELD)] <- unlist(MITREordered$Shield[i])[aux+1]"
"0","      aux <- aux + 1"
"0",""
"0","    }"
"0",""
"0",""
"0",""
"0","  }else"
"0","    {"
"0","      MITRESHIELD <- rbind(MITRESHIELD,MITREordered[i,])"
"0","    }"
"0",""
"0","  i <- i + j"
"0",""
"0","}"
"0",""
"0","i <- 1"
"0",""
"0","while (i<= nrow(MITRESHIELD))"
"0","{"
"0","  aux <- grep(paste(""^"",MITRESHIELD$Shield[i],""$"",sep=""""),shield.techniques$id)"
"0","  MITRESHIELD$ShieldName[i] <- unlist(shield.techniques$name[aux])"
"0","  MITRESHIELD$ShieldDesc[i] <- list(shield.techniques$description[aux])"
"0","  i <- i + 1"
"0",""
"0","}"
"0",""
"0","MITRESHIELD$ShieldName <- unlist(MITRESHIELD$ShieldName)"
"0",""
"0","graphic2 <- ggplot(data = MITRESHIELD, mapping = aes(ShieldName,Name))"
"0",""
"0","graphic2 + geom_point() + # Show dots"
"0",""
"0","  geom_label("
"0","    label=MITRESHIELD$CAPEC,"
"0","    nudge_x = 0, nudge_y = 0,"
"0","  ) +"
"0","  xlab(""Técnicas de Defensa"") +"
"0","  ylab(""Técnicas de Ataque"") +"
"0","  ggtitle(paste(""Técnicas de Defensa vs Técnicas de Ataque y sus respectivas CAPEC de"",producto,sep = "" "")) +"
"0","  labs(fill = ""CAPEC"")"
"0",""
