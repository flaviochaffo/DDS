"0","#DMAttack2"
"0","library(jsonlite)"
"0","library(mitre)"
"0","library(burro)"
"0","library(dplyr)"
"0","library(ggplot2)"
"0","library(plyr)"
"0","library(markdown)"
"0","library(knitr)"
"0","library(stringr)"
"0","library(ggrepel)"
"0",""
"0","i <- 1"
"0","while (i<= nrow(CAPECordered))"
"0","  {"
"0","    aux <- grep(CAPECordered$CAPEC[i],capec.patterns$id)"
"0","    CAPECordered$Name[i] <- capecs.patterns$name[aux]"
"0","    CAPECordered$Description[i] <- capec.patterns$description[aux]"
"0","    CAPECordered$Likelihood[i] <- capec.patterns$likelihood[aux]"
"0","    CAPECordered$Severity[i] <- capec.patterns$severity[aux]"
"0","    CAPECordered$LikelihoodScore[i] <- switch(CAPECordered$Likelihood[i],""Unknown""=1,""Low""=2,""Medium""=3,""High""=4)"
"0","    CAPECordered$SeverityScore[i] <- switch(CAPECordered$Severity[i],""Unknown""=1,""Very Low""=2,""Low""=3,""Medium""=4,""High""=5,""Very High""=6)"
"0","    CAPECordered$RiskScore[i] <- CAPECordered$LikelihoodScore[i]*CAPECordered$SeverityScore[i]"
"0",""
"0","    if (CAPECordered$RiskScore[i]<=6){"
"0","      CAPECordered$Risk[i] <- ""Low"""
"0","    }"
"0","    if ((CAPECordered$RiskScore[i]>6)&(CAPECordered$RiskScore[i]<=12)){"
"0",""
"0","      CAPECordered$Risk[i] <- ""Medium"""
"0","    }"
"0","    if ((CAPECordered$RiskScore[i]>12)&(CAPECordered$RiskScore[i]<18)){"
"0",""
"0","      CAPECordered$Risk[i] <- ""High"""
"0","    }"
"0","    if (CAPECordered$RiskScore[i]>=18){"
"0",""
"0","      CAPECordered$Risk[i] <- ""Critical"""
"0","    }"
"0",""
"0","    i <- i + 1"
"0","}"
"0",""
"0",""
"0","plot <- ggplot(CAPECordered, aes(x = Likelihood, y = Severity)) + geom_tile(aes(fill= Risk)) + scale_fill_manual(breaks = c(""Critical"",""High"",""Medium"",""Low""),values = c(""Red"",""Orange"",""Yellow"",""Green""))"
"0","plot + scale_x_discrete(limit = c(""Unknown"", ""Low"", ""Medium"",""High""))+"
"0","  scale_y_discrete(limit = c(""Unknown"",""Very Low"", ""Low"", ""Medium"",""High"",""Very High"")) + geom_label_repel(label=CAPECordered$CAPEC,"
"0","                                                                                          nudge_x = 0, nudge_y = 0,"
"0","                                                                                          size =3, max.overlaps = 139)"
